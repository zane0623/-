# è”æNFTé¢„å”®ã€æ”¶è´§åŠç¬¬ä¸‰æ–¹ç›‘ç®¡æµç¨‹è®¾è®¡

> å‚è€ƒç¾å›¢æ¶ˆè´¹åˆ¸æ¨¡å¼ï¼Œæ„å»ºå®‰å…¨å¯ä¿¡çš„å†œäº§å“NFTé¢„å”®äº¤æ˜“é—­ç¯

## ğŸ“‹ ç›®å½•

- [ä¸šåŠ¡æ¨¡å¼æ¦‚è¿°](#ä¸šåŠ¡æ¨¡å¼æ¦‚è¿°)
- [å®Œæ•´æµç¨‹å›¾](#å®Œæ•´æµç¨‹å›¾)
- [é¢„å”®æµç¨‹](#é¢„å”®æµç¨‹)
- [æ”¶è´§æµç¨‹](#æ”¶è´§æµç¨‹)
- [ç¬¬ä¸‰æ–¹ç›‘ç®¡æµç¨‹](#ç¬¬ä¸‰æ–¹ç›‘ç®¡æµç¨‹)
- [èµ„é‡‘ç®¡ç†](#èµ„é‡‘ç®¡ç†)
- [äº‰è®®å¤„ç†](#äº‰è®®å¤„ç†)
- [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)

---

## ä¸šåŠ¡æ¨¡å¼æ¦‚è¿°

### æ ¸å¿ƒç†å¿µ

**ç±»æ¯”ç¾å›¢æ¶ˆè´¹åˆ¸**ï¼šå¹³å°ä½œä¸ºå¯ä¿¡ç¬¬ä¸‰æ–¹ï¼Œåœ¨ä¹°å–åŒæ–¹ä¹‹é—´æä¾›æ‹…ä¿æœåŠ¡ï¼Œç¡®ä¿"é’±è´§ä¸¤æ¸…"ã€‚

```
ä¹°å®¶ â†â†’ å¹³å°ï¼ˆæ‹…ä¿æ–¹ï¼‰ â†â†’ å–å®¶ï¼ˆæœå›­ï¼‰
        â†“
    æ™ºèƒ½åˆçº¦ï¼ˆé“¾ä¸Šæ‹…ä¿ï¼‰
```

### ä¸‰æ–¹è§’è‰²

| è§’è‰² | èŒè´£ | æƒé™ |
|------|------|------|
| **ä¹°å®¶** | è´­ä¹°NFTã€ç¡®è®¤æ”¶è´§ã€è¯„ä»· | æ”¯ä»˜ã€ç¡®è®¤ã€ç”³è¯‰ |
| **å–å®¶ï¼ˆæœå›­ï¼‰** | ç”Ÿäº§ã€å‘è´§ã€æç° | ä¸Šä¼ æº¯æºã€å‘è´§ã€æ”¶æ¬¾ |
| **å¹³å°ï¼ˆç›‘ç®¡æ–¹ï¼‰** | æ‹…ä¿èµ„é‡‘ã€ç›‘ç®¡æµç¨‹ã€å¤„ç†çº çº· | å†»ç»“/é‡Šæ”¾èµ„é‡‘ã€ä»²è£ |
| **æ™ºèƒ½åˆçº¦** | è‡ªåŠ¨æ‰§è¡Œã€èµ„é‡‘æ‰˜ç®¡ | æŒ‰è§„åˆ™è‡ªåŠ¨æ‰§è¡Œ |

### å…³é”®æœºåˆ¶

1. **èµ„é‡‘æ‰˜ç®¡** - ä¹°å®¶ä»˜æ¬¾åèµ„é‡‘å†»ç»“åœ¨æ™ºèƒ½åˆçº¦ä¸­
2. **åˆ†æ®µé‡Šæ”¾** - æŒ‰ç¡®è®¤æ”¶è´§ã€è´¨é‡éªŒæ”¶ç­‰èŠ‚ç‚¹åˆ†æ®µé‡Šæ”¾èµ„é‡‘
3. **è¶…æ—¶æœºåˆ¶** - è¶…è¿‡æœŸé™è‡ªåŠ¨ç¡®è®¤æˆ–é€€æ¬¾
4. **äº‰è®®ä»²è£** - å¹³å°ä»‹å…¥å¤„ç†çº çº·
5. **ä¿¡ç”¨ä½“ç³»** - ä¹°å–åŒæ–¹ä¿¡ç”¨è¯„åˆ†å½±å“äº¤æ˜“

---

## å®Œæ•´æµç¨‹å›¾

### æ•´ä½“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è”æNFTäº¤æ˜“å®Œæ•´æµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µ1: é¢„å”®æœŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸Šæ¶NFT  â”‚ â†’  â”‚ ç”¨æˆ·æµè§ˆ â”‚ â†’  â”‚ ä¸‹å•æ”¯ä»˜ â”‚ â†’  â”‚ èµ„é‡‘æ‰˜ç®¡ â”‚
â”‚ (æœå›­)   â”‚    â”‚ (ä¹°å®¶)   â”‚    â”‚ (ä¹°å®¶)   â”‚    â”‚ (åˆçº¦)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µ2: ç”Ÿäº§æœŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç§æ¤å…»æŠ¤ â”‚ â†’  â”‚ ä¸Šä¼ æº¯æº â”‚ â†’  â”‚ ç”¨æˆ·æŸ¥çœ‹ â”‚
â”‚ (æœå›­)   â”‚    â”‚ (æœå›­)   â”‚    â”‚ (ä¹°å®¶)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µ3: é‡‡æ‘˜é…é€æœŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡‡æ‘˜æ‰“åŒ… â”‚ â†’  â”‚ å‘è´§é€šçŸ¥ â”‚ â†’  â”‚ ç‰©æµè¿½è¸ª â”‚ â†’  â”‚ ç­¾æ”¶é€šçŸ¥ â”‚
â”‚ (æœå›­)   â”‚    â”‚ (æœå›­)   â”‚    â”‚ (ç‰©æµ)   â”‚    â”‚ (ä¹°å®¶)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µ4: ç¡®è®¤æ”¶è´§æœŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éªŒæ”¶è”æ â”‚ â†’  â”‚ ç¡®è®¤æ”¶è´§ â”‚ â†’  â”‚ é‡Šæ”¾èµ„é‡‘ â”‚
â”‚ (ä¹°å®¶)   â”‚    â”‚ (ä¹°å®¶)   â”‚    â”‚ (åˆçº¦)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
                 å¯é€‰: ç”³è¯‰
                      â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ å¹³å°ä»‹å…¥ä»²è£ â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µ5: å”®åæœŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯„ä»·æ™’å• â”‚ â†’  â”‚ ç§¯åˆ†å¥–åŠ± â”‚ â†’  â”‚ ä¿¡ç”¨æ›´æ–° â”‚
â”‚ (ä¹°å®¶)   â”‚    â”‚ (å¹³å°)   â”‚    â”‚ (ç³»ç»Ÿ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é¢„å”®æµç¨‹

### 1. é¢„å”®å‡†å¤‡ï¼ˆæœå›­æ“ä½œï¼‰

#### 1.1 åˆ›å»ºé¢„å”®æ´»åŠ¨

**æ“ä½œæ­¥éª¤**ï¼š
```
1. æœå›­ç™»å½•ç”Ÿäº§åŸºåœ°ç«¯
2. å¡«å†™é¢„å”®ä¿¡æ¯ï¼š
   - è”æå“ç§ï¼ˆæé¾™è›‹ï¼‰
   - é¢„å”®æ•°é‡ï¼ˆ1000ä»½ï¼‰
   - é¢„å”®ä»·æ ¼ï¼ˆ298å…ƒ/ä»½ï¼‰
   - é¢„è®¡é‡‡æ‘˜æ—¶é—´ï¼ˆ2024å¹´6æœˆï¼‰
   - é…é€èŒƒå›´ï¼ˆå…¨å›½ï¼‰
3. ä¸Šä¼ æœå›­è®¤è¯èµ„æ–™
4. è®¾ç½®NFTå…ƒæ•°æ®
5. æäº¤å¹³å°å®¡æ ¸
```

**æ•°æ®ç»“æ„**ï¼š
```json
{
  "presale_id": "PS20240001",
  "orchard_id": "OR001",
  "product": {
    "name": "é’œå›­æé¾™è›‹è”æ",
    "variety": "æé¾™è›‹",
    "weight": "5æ–¤/ä»½",
    "grade": "ç‰¹çº§",
    "description": "å¹¿ä¸œèŒ‚åé’œå›­å†œä¸šæé¾™è›‹è”æ..."
  },
  "pricing": {
    "presale_price": 298.00,
    "market_price": 398.00,
    "discount_rate": 0.25
  },
  "quantity": {
    "total": 1000,
    "available": 1000,
    "sold": 0
  },
  "timeline": {
    "presale_start": "2024-03-01",
    "presale_end": "2024-05-31",
    "harvest_date": "2024-06-15",
    "delivery_deadline": "2024-06-30"
  },
  "status": "pending_review"
}
```

#### 1.2 å¹³å°å®¡æ ¸

**å®¡æ ¸å†…å®¹**ï¼š
- âœ… æœå›­èµ„è´¨éªŒè¯
- âœ… äº§å“ä¿¡æ¯çœŸå®æ€§
- âœ… ä»·æ ¼åˆç†æ€§
- âœ… ä¾›åº”èƒ½åŠ›è¯„ä¼°
- âœ… å†å²ä¿¡ç”¨è®°å½•

**å®¡æ ¸æµç¨‹**ï¼š
```
æäº¤ â†’ åˆå®¡ï¼ˆè‡ªåŠ¨ï¼‰ â†’ äººå·¥å®¡æ ¸ â†’ æ‰¹å‡†/é©³å›
      â†“
   é£æ§æ£€æŸ¥
      â†“
   èµ„è´¨æ ¸éªŒ
```

**å®¡æ ¸é€šè¿‡å**ï¼š
- ç”ŸæˆNFTåˆçº¦åœ°å€
- é“¸é€ NFTåˆ°æœå›­é’±åŒ…
- ä¸Šæ¶åˆ°é¢„å”®å¸‚åœº
- å‘é€é€šçŸ¥ç»™æœå›­

### 2. ç”¨æˆ·ä¸‹å•ï¼ˆä¹°å®¶æ“ä½œï¼‰

#### 2.1 æµè§ˆé€‰è´­

**ç”¨æˆ·ç•Œé¢**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸˆ æé¾™è›‹è”æNFT - é™é‡é¢„å”®         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [è”æå›¾ç‰‡]                          â”‚
â”‚                                      â”‚
â”‚  â­â­â­â­â­ 4.9åˆ† (328æ¡è¯„ä»·)          â”‚
â”‚                                      â”‚
â”‚  ğŸ’° Â¥298  åŸä»·: Â¥398  çœÂ¥100        â”‚
â”‚                                      â”‚
â”‚  ğŸ“¦ é¢„è®¡6æœˆä¸­æ—¬å‘è´§                  â”‚
â”‚  ğŸšš åŒ…é‚®åˆ°å®¶ | åæœåŒ…èµ”              â”‚
â”‚                                      â”‚
â”‚  ğŸ“Š å·²å”®: 568/1000                   â”‚
â”‚  â° è·ç»“æŸ: 45å¤©23å°æ—¶               â”‚
â”‚                                      â”‚
â”‚  [æŸ¥çœ‹æº¯æº] [ç«‹å³è´­ä¹°]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2 ä¸‹å•æ”¯ä»˜

**æ”¯ä»˜æµç¨‹**ï¼š
```
1. é€‰æ‹©æ•°é‡ï¼ˆé»˜è®¤1ä»½ï¼‰
2. å¡«å†™æ”¶è´§åœ°å€
3. é€‰æ‹©æ”¯ä»˜æ–¹å¼ï¼š
   âœ“ å¾®ä¿¡æ”¯ä»˜
   âœ“ æ”¯ä»˜å®
   âœ“ USDTï¼ˆé“¾ä¸Šæ”¯ä»˜ï¼‰
   âœ“ é“¶è¡Œå¡
4. ç¡®è®¤è®¢å•ä¿¡æ¯
5. å®Œæˆæ”¯ä»˜
```

**è®¢å•æ•°æ®**ï¼š
```json
{
  "order_id": "ORD20240315001",
  "buyer_id": "USER123",
  "presale_id": "PS20240001",
  "nft_token_id": "1001",
  "payment": {
    "amount": 298.00,
    "method": "wechat_pay",
    "transaction_id": "WX20240315123456",
    "paid_at": "2024-03-15 10:30:25"
  },
  "shipping": {
    "recipient": "å¼ ä¸‰",
    "phone": "138****8888",
    "address": "å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒº...",
    "note": "è¯·åœ¨å·¥ä½œæ—¥é€è´§"
  },
  "status": "paid",
  "created_at": "2024-03-15 10:28:30"
}
```

### 3. èµ„é‡‘æ‰˜ç®¡ï¼ˆæ™ºèƒ½åˆçº¦è‡ªåŠ¨æ‰§è¡Œï¼‰

#### 3.1 èµ„é‡‘é”å®š

**åˆçº¦é€»è¾‘**ï¼š
```solidity
function purchaseNFT(uint256 tokenId) public payable {
    require(msg.value >= presalePrice, "Insufficient payment");
    
    // èµ„é‡‘é”å®šåœ¨åˆçº¦ä¸­
    escrowBalance[tokenId] = msg.value;
    
    // è®°å½•ä¹°å®¶
    buyers[tokenId] = msg.sender;
    
    // è½¬ç§»NFTæ‰€æœ‰æƒï¼ˆä½†æ ‡è®°ä¸ºé”å®šçŠ¶æ€ï¼‰
    _transfer(seller, msg.sender, tokenId);
    nftStatus[tokenId] = Status.Locked;
    
    // è®°å½•æ‰˜ç®¡ä¿¡æ¯
    escrows[tokenId] = Escrow({
        buyer: msg.sender,
        seller: seller,
        amount: msg.value,
        status: EscrowStatus.Locked,
        createdAt: block.timestamp,
        deliveryDeadline: harvestDate + 15 days
    });
    
    emit NFTPurchased(tokenId, msg.sender, msg.value);
}
```

#### 3.2 èµ„é‡‘åˆ†é…è§„åˆ™

**åˆ†æ®µé‡Šæ”¾æœºåˆ¶**ï¼š
```
æ€»é‡‘é¢: 298å…ƒ

åˆ†é…æ–¹æ¡ˆ:
â”œâ”€ å¹³å°æœåŠ¡è´¹(5%): 14.90å…ƒ â†’ ç«‹å³æ‰£é™¤
â”œâ”€ ç‰©æµè´¹ç”¨(10%): 29.80å…ƒ â†’ å‘è´§æ—¶é‡Šæ”¾ç»™ç‰©æµ
â”œâ”€ æœå›­é¦–æ¬¾(30%): 89.40å…ƒ â†’ å‘è´§æ—¶é‡Šæ”¾
â”œâ”€ æœå›­å°¾æ¬¾(55%): 164.90å…ƒ â†’ ç¡®è®¤æ”¶è´§åé‡Šæ”¾
â””â”€ æ€»è®¡: 298.00å…ƒ

æ—¶é—´çº¿:
æ”¯ä»˜æ—¶ â†’ å¹³å°æ‰£é™¤æœåŠ¡è´¹
å‘è´§æ—¶ â†’ é‡Šæ”¾ç‰©æµè´¹ + é¦–æ¬¾
æ”¶è´§å â†’ é‡Šæ”¾å°¾æ¬¾ï¼ˆ7å¤©åè‡ªåŠ¨æˆ–æ‰‹åŠ¨ç¡®è®¤ï¼‰
```

### 4. NFTé“¸é€ ä¸è½¬ç§»

**NFTå…ƒæ•°æ®**ï¼š
```json
{
  "name": "é’œå›­æé¾™è›‹è”æ #1001",
  "description": "2024å¹´å¹¿ä¸œèŒ‚åé’œå›­å†œä¸šæé¾™è›‹è”æé¢„å”®NFT",
  "image": "ipfs://Qm...",
  "attributes": [
    {
      "trait_type": "å“ç§",
      "value": "æé¾™è›‹"
    },
    {
      "trait_type": "é‡é‡",
      "value": "5æ–¤"
    },
    {
      "trait_type": "ç­‰çº§",
      "value": "ç‰¹çº§"
    },
    {
      "trait_type": "äº§åœ°",
      "value": "å¹¿ä¸œèŒ‚å"
    },
    {
      "trait_type": "é¢„è®¡é‡‡æ‘˜æ—¶é—´",
      "value": "2024-06"
    },
    {
      "trait_type": "è®¢å•å·",
      "value": "ORD20240315001"
    }
  ],
  "external_url": "https://lychee-nft.com/nft/1001",
  "rights": [
    "æè´§æƒï¼š2024å¹´6æœˆé‡‡æ‘˜å­£å¯å…‘æ¢5æ–¤æé¾™è›‹è”æ",
    "æº¯æºæƒï¼šæŸ¥çœ‹å®Œæ•´ç”Ÿäº§æº¯æºæ•°æ®",
    "è½¬è®©æƒï¼šå¯åœ¨äºŒçº§å¸‚åœºè½¬è®©NFT",
    "åˆ†çº¢æƒï¼šæœå›­ç›ˆåˆ©æ—¶æŒ‰æŒæœ‰æ¯”ä¾‹åˆ†çº¢"
  ]
}
```

---

## æ”¶è´§æµç¨‹

### 1. ç”Ÿäº§æœŸè¿½è¸ªï¼ˆæœå›­æ“ä½œï¼‰

#### 1.1 æº¯æºæ•°æ®ä¸Šä¼ 

**æ•°æ®ç±»å‹**ï¼š
```
å®šæœŸä¸Šä¼ ï¼ˆæ¯å‘¨ï¼‰:
â”œâ”€ æœæ ‘ç”Ÿé•¿ç…§ç‰‡
â”œâ”€ ç¯å¢ƒæ•°æ®ï¼ˆæ¸©åº¦ã€æ¹¿åº¦ã€é™é›¨ï¼‰
â”œâ”€ å…»æŠ¤è®°å½•ï¼ˆæ–½è‚¥ã€ä¿®å‰ªã€ç—…è™«å®³é˜²æ²»ï¼‰
â”œâ”€ è´¨æ£€æŠ¥å‘Š
â””â”€ è§†é¢‘è®°å½•

é‡Œç¨‹ç¢‘äº‹ä»¶:
â”œâ”€ å¼€èŠ±æœŸï¼ˆæ‹ç…§ä¸Šä¼ ï¼‰
â”œâ”€ åæœæœŸï¼ˆæ‹ç…§ä¸Šä¼ ï¼‰
â”œâ”€ è†¨æœæœŸï¼ˆæ¯å‘¨æ›´æ–°ï¼‰
â”œâ”€ æˆç†ŸæœŸï¼ˆè´¨æ£€æŠ¥å‘Šï¼‰
â””â”€ é‡‡æ‘˜æœŸï¼ˆé‡‡æ‘˜è§†é¢‘ï¼‰
```

**æº¯æºæ•°æ®ç»“æ„**ï¼š
```json
{
  "trace_id": "TR20240401001",
  "nft_token_id": "1001",
  "date": "2024-04-01",
  "stage": "flowering",
  "data": {
    "photos": [
      "ipfs://Qm.../flower1.jpg",
      "ipfs://Qm.../flower2.jpg"
    ],
    "environment": {
      "temperature_avg": 25.5,
      "humidity_avg": 75.2,
      "rainfall": 15.3
    },
    "maintenance": {
      "fertilizer": "æœ‰æœºè‚¥",
      "pest_control": "ç”Ÿç‰©é˜²æ²»",
      "pruning": "ç–èŠ±ç–æœ"
    },
    "notes": "æœæ ‘å¼€èŠ±æƒ…å†µè‰¯å¥½ï¼Œé¢„è®¡åæœç‡85%ä»¥ä¸Š"
  },
  "blockchain_hash": "0x...",
  "uploaded_at": "2024-04-01 15:30:00"
}
```

#### 1.2 ç”¨æˆ·æŸ¥çœ‹æº¯æº

**å°ç¨‹åºç•Œé¢**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æˆ‘çš„è”æ #1001                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æœæ ‘å®æ—¶ç…§ç‰‡]                      â”‚
â”‚                                      â”‚
â”‚  ğŸ“ å½“å‰é˜¶æ®µ: è†¨æœæœŸ                 â”‚
â”‚  ğŸ“… å·²ç”Ÿé•¿: 45å¤©                     â”‚
â”‚  ğŸŒ¡ï¸ ä»Šæ—¥æ¸©åº¦: 28Â°C                   â”‚
â”‚  ğŸ’§ ä»Šæ—¥æ¹¿åº¦: 72%                    â”‚
â”‚                                      â”‚
â”‚  â”€â”€â”€â”€ ç”Ÿé•¿æ—¶é—´çº¿ â”€â”€â”€â”€               â”‚
â”‚  âœ… 2024-03-15 è´­ä¹°NFT               â”‚
â”‚  âœ… 2024-03-20 å¼€èŠ±æœŸ                â”‚
â”‚  âœ… 2024-04-01 åæœæœŸ                â”‚
â”‚  ğŸ”µ 2024-04-15 è†¨æœæœŸï¼ˆå½“å‰ï¼‰        â”‚
â”‚  â³ 2024-06-15 æˆç†Ÿé‡‡æ‘˜              â”‚
â”‚                                      â”‚
â”‚  [æŸ¥çœ‹è¯¦ç»†æº¯æº] [é‚€è¯·å¥½å‹å›´è§‚]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. é‡‡æ‘˜é…é€æœŸï¼ˆæœå›­ + ç‰©æµï¼‰

#### 2.1 é‡‡æ‘˜æ‰“åŒ…

**æœå›­æ“ä½œæµç¨‹**ï¼š
```
1. åˆ°æœŸæé†’:
   - ç³»ç»Ÿæå‰7å¤©æé†’æœå›­å‡†å¤‡é‡‡æ‘˜
   - é€šçŸ¥ç”¨æˆ·é¢„è®¡é‡‡æ‘˜æ—¶é—´
   
2. é‡‡æ‘˜ä½œä¸š:
   - æŒ‰è®¢å•æ‰¹æ¬¡é‡‡æ‘˜
   - ç°åœºæ‹ç…§/è§†é¢‘è®°å½•
   - è´¨æ£€åˆ†çº§
   
3. æ‰“åŒ…è£…ç®±:
   - ç²¾é€‰è£…ç®±ï¼ˆæ¯ä»½5æ–¤ï¼Œçº¦15-20é¢—ï¼‰
   - åŠ å†°è¢‹ä¿é²œ
   - è´´è®¢å•æ ‡ç­¾ï¼ˆå«äºŒç»´ç ï¼‰
   - å°ç®±æ‹ç…§
   
4. ç§°é‡å¤æ ¸:
   - éªŒè¯é‡é‡â‰¥5æ–¤
   - æ‹ç…§ä¸Šä¼ 
   - ç”Ÿæˆå‘è´§å‡­è¯
```

**æ‰“åŒ…æ•°æ®**ï¼š
```json
{
  "package_id": "PKG20240615001",
  "order_id": "ORD20240315001",
  "nft_token_id": "1001",
  "harvest_data": {
    "picked_at": "2024-06-15 06:30:00",
    "picker": "æå¸ˆå‚…",
    "tree_number": "AåŒº-15å·æ ‘",
    "photos": [
      "ipfs://Qm.../harvest1.jpg",
      "ipfs://Qm.../harvest2.jpg"
    ]
  },
  "package_data": {
    "weight": 5.2,
    "quantity": 18,
    "grade": "ç‰¹çº§",
    "box_photo": "ipfs://Qm.../box.jpg",
    "qr_code": "https://lychee-nft.com/track/PKG20240615001"
  },
  "packed_at": "2024-06-15 08:00:00"
}
```

#### 2.2 å‘è´§é€šçŸ¥

**ç³»ç»Ÿè‡ªåŠ¨è§¦å‘**ï¼š
```
1. æœå›­ç‚¹å‡»"ç¡®è®¤å‘è´§"
2. ä¸Šä¼ å¿«é€’å•å·
3. è§¦å‘æ™ºèƒ½åˆçº¦äº‹ä»¶
4. é‡Šæ”¾é¦–æ¬¾ï¼ˆ30%ï¼‰+ ç‰©æµè´¹ï¼ˆ10%ï¼‰ç»™æœå›­
5. å‘é€é€šçŸ¥ç»™ä¹°å®¶
6. å¼€å§‹å€’è®¡æ—¶ï¼ˆ15å¤©æ”¶è´§æœŸé™ï¼‰
```

**å‘è´§æ•°æ®**ï¼š
```json
{
  "shipment_id": "SHIP20240615001",
  "order_id": "ORD20240315001",
  "logistics": {
    "company": "é¡ºä¸°é€Ÿè¿",
    "tracking_number": "SF1234567890",
    "shipped_at": "2024-06-15 10:00:00",
    "estimated_arrival": "2024-06-17"
  },
  "payment_released": {
    "to_orchard": 89.40,
    "to_logistics": 29.80,
    "timestamp": "2024-06-15 10:01:00",
    "tx_hash": "0x..."
  }
}
```

**ä¹°å®¶æ”¶åˆ°é€šçŸ¥**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ æ‚¨çš„è”æå·²å‘è´§                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‚¨çš„æé¾™è›‹è”æå·²ç”±é’œå›­å†œä¸šå‘å‡º      â”‚
â”‚                                      â”‚
â”‚  ç‰©æµ: é¡ºä¸°é€Ÿè¿                      â”‚
â”‚  å•å·: SF1234567890                  â”‚
â”‚  é¢„è®¡: 6æœˆ17æ—¥é€è¾¾                   â”‚
â”‚                                      â”‚
â”‚  [å®æ—¶è¿½è¸ª] [è”ç³»æœå›­]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.3 ç‰©æµè¿½è¸ª

**ç‰©æµçŠ¶æ€åŒæ­¥**ï¼š
```
ç‰©æµèŠ‚ç‚¹å®æ—¶æ›´æ–°:
â”œâ”€ 2024-06-15 10:30 æ½ä»¶æˆåŠŸï¼ˆèŒ‚åå¸‚ï¼‰
â”œâ”€ 2024-06-15 18:45 åˆ°è¾¾è½¬è¿ä¸­å¿ƒï¼ˆèŒ‚åï¼‰
â”œâ”€ 2024-06-16 02:15 åˆ°è¾¾è½¬è¿ä¸­å¿ƒï¼ˆå¹¿å·ï¼‰
â”œâ”€ 2024-06-16 15:30 æ´¾ä»¶ä¸­ï¼ˆå¤©æ²³åŒºï¼‰
â””â”€ 2024-06-17 09:45 å·²ç­¾æ”¶

å¼‚å¸¸çŠ¶æ€å¤„ç†:
â”œâ”€ è¿è¾“å»¶è¿Ÿ â†’ é€šçŸ¥ä¹°å®¶ + å»¶é•¿æ”¶è´§æœŸ
â”œâ”€ åŒ…è£¹ç ´æŸ â†’ æ‹ç…§ä¸Šä¼  + ç”³è¯·ç†èµ”
â”œâ”€ åœ°å€é”™è¯¯ â†’ è”ç³»ä¹°å®¶ + ä¿®æ”¹åœ°å€
â””â”€ æ— äººç­¾æ”¶ â†’ è”ç³»ä¹°å®¶ + å¿«é€’æŸœ/ä»£æ”¶
```

### 3. ç¡®è®¤æ”¶è´§æœŸï¼ˆä¹°å®¶æ“ä½œï¼‰

#### 3.1 ç­¾æ”¶éªŒè´§

**ç­¾æ”¶æé†’**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… æ‚¨çš„è”æå·²é€è¾¾                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¿«é€’å·²ç­¾æ”¶ï¼Œè¯·åŠæ—¶éªŒæ”¶              â”‚
â”‚                                      â”‚
â”‚  ğŸ“‹ éªŒæ”¶æç¤º:                        â”‚
â”‚  1. æ£€æŸ¥åŒ…è£…æ˜¯å¦å®Œå¥½                 â”‚
â”‚  2. ç§°é‡æ˜¯å¦è¶³å¤Ÿï¼ˆâ‰¥5æ–¤ï¼‰             â”‚
â”‚  3. è”ææ˜¯å¦æ–°é²œ                     â”‚
â”‚  4. æœ‰æ— ç ´æŸ/å˜è´¨                    â”‚
â”‚                                      â”‚
â”‚  è¯·åœ¨7å¤©å†…ç¡®è®¤æ”¶è´§                   â”‚
â”‚  å¦‚æœ‰é—®é¢˜è¯·åŠæ—¶ç”³è¯‰                  â”‚
â”‚                                      â”‚
â”‚  [ç¡®è®¤æ”¶è´§] [ç”³è¯·å”®å]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 ç¡®è®¤æ”¶è´§

**ç¡®è®¤æµç¨‹**ï¼š
```
æ–¹å¼ä¸€: ä¸»åŠ¨ç¡®è®¤ï¼ˆæ¨èï¼‰
ç”¨æˆ·æ£€æŸ¥æ— è¯¯ â†’ ç‚¹å‡»"ç¡®è®¤æ”¶è´§" â†’ è§¦å‘åˆçº¦ â†’ é‡Šæ”¾å°¾æ¬¾

æ–¹å¼äºŒ: è‡ªåŠ¨ç¡®è®¤ï¼ˆè¶…æ—¶ï¼‰
ç­¾æ”¶å7å¤© â†’ ç³»ç»Ÿè‡ªåŠ¨ç¡®è®¤ â†’ è§¦å‘åˆçº¦ â†’ é‡Šæ”¾å°¾æ¬¾

æ–¹å¼ä¸‰: ç”³è¯‰å¤„ç†
å‘ç°é—®é¢˜ â†’ ç”³è¯·å”®å â†’ å¹³å°ä»‹å…¥ â†’ ä»²è£ç»“æœ â†’ èµ„é‡‘å¤„ç†
```

**ç¡®è®¤æ”¶è´§åˆçº¦**ï¼š
```solidity
function confirmDelivery(uint256 tokenId) public {
    require(buyers[tokenId] == msg.sender, "Not buyer");
    require(escrows[tokenId].status == EscrowStatus.Shipped, "Not shipped");
    
    Escrow storage escrow = escrows[tokenId];
    
    // é‡Šæ”¾å°¾æ¬¾ç»™æœå›­ï¼ˆ55%ï¼‰
    uint256 finalPayment = escrow.amount * 55 / 100;
    payable(escrow.seller).transfer(finalPayment);
    
    // è§£é”NFT
    nftStatus[tokenId] = Status.Unlocked;
    
    // æ›´æ–°æ‰˜ç®¡çŠ¶æ€
    escrow.status = EscrowStatus.Completed;
    escrow.confirmedAt = block.timestamp;
    
    emit DeliveryConfirmed(tokenId, msg.sender, finalPayment);
}

// è‡ªåŠ¨ç¡®è®¤ï¼ˆ7å¤©åï¼‰
function autoConfirmDelivery(uint256 tokenId) public {
    Escrow storage escrow = escrows[tokenId];
    require(escrow.status == EscrowStatus.Shipped, "Not shipped");
    require(block.timestamp >= escrow.deliveredAt + 7 days, "Too early");
    
    // æ‰§è¡Œç¡®è®¤é€»è¾‘ï¼ˆåŒä¸Šï¼‰
    _confirmDelivery(tokenId);
}
```

### 4. è¯„ä»·æ™’å•ï¼ˆä¹°å®¶æ“ä½œï¼‰

#### 4.1 è¯„ä»·ç³»ç»Ÿ

**è¯„ä»·ç»´åº¦**ï¼š
```
æ•´ä½“è¯„åˆ†: â­â­â­â­â­ (1-5æ˜Ÿ)

ç»†åˆ†è¯„åˆ†:
â”œâ”€ è”æå“è´¨: â­â­â­â­â­
â”œâ”€ é‡é‡è¶³å¤Ÿ: â­â­â­â­â­
â”œâ”€ åŒ…è£…å®Œå¥½: â­â­â­â­â­
â”œâ”€ ç‰©æµé€Ÿåº¦: â­â­â­â­â­
â””â”€ æœåŠ¡æ€åº¦: â­â­â­â­â­

æ–‡å­—è¯„ä»·: ï¼ˆé€‰å¡«ï¼‰
ç…§ç‰‡ä¸Šä¼ : ï¼ˆæœ€å¤š9å¼ ï¼‰
è§†é¢‘ä¸Šä¼ : ï¼ˆé€‰å¡«ï¼‰

æ ‡ç­¾é€‰æ‹©:
â˜‘ æœè‚‰é¥±æ»¡  â˜‘ å£æ„Ÿæ¸…ç”œ  â˜‘ æ–°é²œå¤šæ±
â˜‘ åŒ…è£…ç²¾ç¾  â˜‘ å‘è´§åŠæ—¶  â–¡ åˆ†é‡ä¸è¶³
```

**è¯„ä»·å¥–åŠ±**ï¼š
```
æ™’å•å¥–åŠ±è§„åˆ™:
â”œâ”€ æ–‡å­—è¯„ä»·ï¼ˆâ‰¥30å­—ï¼‰: 10ç§¯åˆ†
â”œâ”€ å›¾ç‰‡æ™’å•ï¼ˆâ‰¥3å¼ ï¼‰: 20ç§¯åˆ†
â”œâ”€ è§†é¢‘æ™’å•: 50ç§¯åˆ†
â”œâ”€ ç²¾åè¯„ä»·ï¼ˆä¼˜è´¨å†…å®¹ï¼‰: 100ç§¯åˆ†
â””â”€ ç§¯åˆ†å¯å…‘æ¢: ä¼˜æƒ åˆ¸ã€ä¸‹æ¬¡é¢„å”®ä¼˜å…ˆæƒ
```

---

## ç¬¬ä¸‰æ–¹ç›‘ç®¡æµç¨‹

### 1. å¹³å°ç›‘ç®¡èŒè´£

#### 1.1 å…¨æµç¨‹ç›‘ç®¡

**ç›‘ç®¡å†…å®¹**ï¼š
```
é¢„å”®é˜¶æ®µ:
â”œâ”€ æœå›­èµ„è´¨å®¡æ ¸
â”œâ”€ äº§å“ä¿¡æ¯å®¡æŸ¥
â”œâ”€ ä»·æ ¼åˆç†æ€§ç›‘æ§
â”œâ”€ é¢„å”®æ•°é‡æ ¸éªŒ
â””â”€ åˆè§„æ€§æ£€æŸ¥

ç”Ÿäº§é˜¶æ®µ:
â”œâ”€ æº¯æºæ•°æ®å®¡æ ¸
â”œâ”€ ç”Ÿäº§è¿›åº¦è·Ÿè¸ª
â”œâ”€ è´¨é‡æ ‡å‡†æ£€æŸ¥
â””â”€ å¼‚å¸¸æƒ…å†µé¢„è­¦

é…é€é˜¶æ®µ:
â”œâ”€ å‘è´§åŠæ—¶æ€§ç›‘æ§
â”œâ”€ ç‰©æµçŠ¶æ€è¿½è¸ª
â”œâ”€ é…é€è´¨é‡æŠ½æ£€
â””â”€ å®¢æˆ·æŠ•è¯‰å¤„ç†

æ”¶è´§é˜¶æ®µ:
â”œâ”€ ç¡®è®¤æ”¶è´§ç›‘æ§
â”œâ”€ çº çº·å¤„ç†ä»‹å…¥
â”œâ”€ èµ„é‡‘å®‰å…¨ä¿éšœ
â””â”€ ä¿¡ç”¨è¯„åˆ†æ›´æ–°
```

#### 1.2 é£æ§ç³»ç»Ÿ

**å®æ—¶ç›‘æ§æŒ‡æ ‡**ï¼š
```
æœå›­ç«¯é£é™©:
â”œâ”€ å‘è´§å»¶è¿Ÿç‡ > 10% â†’ é»„è‰²é¢„è­¦
â”œâ”€ æŠ•è¯‰ç‡ > 5% â†’ æ©™è‰²é¢„è­¦
â”œâ”€ é€€æ¬¾ç‡ > 15% â†’ çº¢è‰²é¢„è­¦
â””â”€ ä¿¡ç”¨åˆ† < 60åˆ† â†’ æš‚åœé”€å”®

ä¹°å®¶ç«¯é£é™©:
â”œâ”€ æ¶æ„é€€æ¬¾æ¬¡æ•° > 3æ¬¡ â†’ é™åˆ¶è´­ä¹°
â”œâ”€ æ¶æ„è¯„ä»·æ£€æµ‹ â†’ è´¦å·è­¦å‘Š
â””â”€ ä¿¡ç”¨åˆ† < 60åˆ† â†’ é™åˆ¶éƒ¨åˆ†åŠŸèƒ½

ç³»ç»Ÿé£é™©:
â”œâ”€ å¼‚å¸¸äº¤æ˜“æ£€æµ‹ï¼ˆé‡‘é¢ã€é¢‘ç‡ï¼‰
â”œâ”€ é»„ç‰›åˆ·å•è¯†åˆ«
â”œâ”€ èµ„é‡‘å¼‚å¸¸æµåŠ¨ç›‘æ§
â””â”€ æ™ºèƒ½åˆçº¦å®‰å…¨ç›‘æ§
```

### 2. äº‰è®®å¤„ç†æœºåˆ¶

#### 2.1 äº‰è®®ç±»å‹

**å¸¸è§äº‰è®®åœºæ™¯**ï¼š
```
è´¨é‡é—®é¢˜:
â”œâ”€ é‡é‡ä¸è¶³
â”œâ”€ å“è´¨ä¸ç¬¦ï¼ˆçƒ‚æœã€åæœï¼‰
â”œâ”€ ä¸æè¿°ä¸ç¬¦
â””â”€ åŒ…è£…ç ´æŸ

é…é€é—®é¢˜:
â”œâ”€ å‘è´§å»¶è¿Ÿ
â”œâ”€ ç‰©æµä¸¢ä»¶
â”œâ”€ é…é€è¶…æ—¶
â””â”€ æ— äººç­¾æ”¶

æœåŠ¡é—®é¢˜:
â”œâ”€ æ²Ÿé€šä¸ç•…
â”œâ”€ å”®åä¸ç†
â”œâ”€ æ‰¿è¯ºä¸å…‘ç°
â””â”€ æ€åº¦æ¶åŠ£
```

#### 2.2 ç”³è¯‰æµç¨‹

**ä¹°å®¶ç”³è¯‰**ï¼š
```
æ­¥éª¤1: å‘èµ·ç”³è¯‰
â”œâ”€ é€‰æ‹©é—®é¢˜ç±»å‹
â”œâ”€ ä¸Šä¼ è¯æ®ï¼ˆç…§ç‰‡/è§†é¢‘ï¼‰
â”œâ”€ æè¿°é—®é¢˜
â””â”€ æå‡ºè¯‰æ±‚ï¼ˆé€€æ¬¾/è¡¥å¿/é‡å‘ï¼‰

æ­¥éª¤2: æœå›­å“åº”ï¼ˆ48å°æ—¶å†…ï¼‰
â”œâ”€ æŸ¥çœ‹ç”³è¯‰å†…å®¹
â”œâ”€ æä¾›åè¯
â”œâ”€ åå•†è§£å†³æ–¹æ¡ˆ
â””â”€ æ¥å—/æ‹’ç»è¯‰æ±‚

æ­¥éª¤3: å¹³å°ä»‹å…¥ï¼ˆæœå›­è¶…æ—¶æˆ–åŒæ–¹åå•†ä¸æˆï¼‰
â”œâ”€ å®¡æŸ¥åŒæ–¹è¯æ®
â”œâ”€ è”ç³»ç‰©æµæ ¸å®
â”œâ”€ å‚è€ƒå†å²è®°å½•
â”œâ”€ å’¨è¯¢ä¸“å®¶æ„è§
â””â”€ åšå‡ºä»²è£å†³å®šï¼ˆ5ä¸ªå·¥ä½œæ—¥å†…ï¼‰

æ­¥éª¤4: æ‰§è¡Œä»²è£
â”œâ”€ å…¨é¢é€€æ¬¾
â”œâ”€ éƒ¨åˆ†é€€æ¬¾
â”œâ”€ è¡¥å¿ï¼ˆä¼˜æƒ åˆ¸/ç§¯åˆ†ï¼‰
â”œâ”€ é‡æ–°å‘è´§
â””â”€ ç»´æŒåŸåˆ¤
```

**ç”³è¯‰æ•°æ®**ï¼š
```json
{
  "dispute_id": "DSP20240620001",
  "order_id": "ORD20240315001",
  "type": "quality_issue",
  "complainant": {
    "user_id": "USER123",
    "role": "buyer",
    "evidence": [
      "ipfs://Qm.../broken1.jpg",
      "ipfs://Qm.../broken2.jpg",
      "ipfs://Qm.../weight.jpg"
    ],
    "description": "æ”¶åˆ°çš„è”ææœ‰5é¢—å·²ç»çƒ‚äº†ï¼Œå®é™…é‡é‡åªæœ‰4.5æ–¤ï¼Œæ¯”æ‰¿è¯ºå°‘0.5æ–¤",
    "demand": "ç”³è¯·30%é€€æ¬¾"
  },
  "respondent": {
    "orchard_id": "OR001",
    "response": "å‘è´§æ—¶å·²æ‹ç…§éªŒé‡ï¼Œ5.2æ–¤ã€‚å¯èƒ½æ˜¯è¿è¾“è¿‡ç¨‹ä¸­æ°´åˆ†æµå¤±ã€‚çƒ‚æœæ„¿æ„è¡¥å¿20å…ƒ",
    "evidence": [
      "ipfs://Qm.../package_before.jpg"
    ]
  },
  "platform_decision": {
    "arbitrator": "ADMIN001",
    "result": "partial_refund",
    "refund_amount": 59.60,
    "refund_rate": 0.20,
    "reason": "ç»¼åˆåŒæ–¹è¯æ®ï¼Œè¿è¾“è¿‡ç¨‹ç¡®æœ‰æŸè€—ï¼Œåˆ¤å®š20%é€€æ¬¾",
    "decided_at": "2024-06-22 15:30:00"
  },
  "status": "resolved",
  "created_at": "2024-06-20 10:15:00",
  "resolved_at": "2024-06-22 16:00:00"
}
```

#### 2.3 ä»²è£è§„åˆ™

**é€€æ¬¾æ¯”ä¾‹æ ‡å‡†**ï¼š
```
è´¨é‡é—®é¢˜:
â”œâ”€ è½»å¾®ç‘•ç–µï¼ˆ1-2é¢—åæœï¼‰: 10%é€€æ¬¾
â”œâ”€ ä¸­ç­‰é—®é¢˜ï¼ˆ3-5é¢—åæœï¼‰: 20-30%é€€æ¬¾
â”œâ”€ ä¸¥é‡é—®é¢˜ï¼ˆ>5é¢—åæœï¼‰: 50%é€€æ¬¾
â””â”€ å®Œå…¨ä¸èƒ½é£Ÿç”¨: 100%é€€æ¬¾

é‡é‡é—®é¢˜:
â”œâ”€ çŸ­ç¼º < 10%: æŒ‰çŸ­ç¼ºæ¯”ä¾‹2å€é€€æ¬¾
â”œâ”€ çŸ­ç¼º 10-20%: 30%é€€æ¬¾
â”œâ”€ çŸ­ç¼º > 20%: 50%é€€æ¬¾
â””â”€ çŸ­ç¼º > 30%: 80%é€€æ¬¾

é…é€é—®é¢˜:
â”œâ”€ å»¶è¿Ÿ1-3å¤©: èµ é€ä¼˜æƒ åˆ¸
â”œâ”€ å»¶è¿Ÿ3-7å¤©: 10%é€€æ¬¾
â”œâ”€ å»¶è¿Ÿ > 7å¤©: 20%é€€æ¬¾ + ä¼˜æƒ åˆ¸
â””â”€ æœªé…é€: 100%é€€æ¬¾

åŒæ–¹è´£ä»»:
â”œâ”€ å®Œå…¨æ˜¯æœå›­è´£ä»»: æœå›­æ‰¿æ‹…
â”œâ”€ å®Œå…¨æ˜¯ä¹°å®¶è´£ä»»: ä¹°å®¶æ‰¿æ‹…
â”œâ”€ ç‰©æµè´£ä»»: å¹³å°åè°ƒç‰©æµèµ”å¿
â””â”€ åŒæ–¹è´£ä»»: æŒ‰æ¯”ä¾‹åˆ†æ‘Š
```

**ä¿¡ç”¨æ‰£åˆ†è§„åˆ™**ï¼š
```
æœå›­:
â”œâ”€ è´¨é‡é—®é¢˜: -5è‡³-20åˆ†
â”œâ”€ å»¶è¿Ÿå‘è´§: -10åˆ†
â”œâ”€ è™šå‡å®£ä¼ : -30åˆ†
â”œâ”€ æ‹’ç»ä»²è£: -50åˆ†
â””â”€ æ¶æ„è¿çº¦: æ°¸ä¹…å°ç¦

ä¹°å®¶:
â”œâ”€ æ¶æ„ç”³è¯‰: -10åˆ†
â”œâ”€ æ— ç†å–é—¹: -20åˆ†
â”œâ”€ æ‹’ç­¾æ¶æ„: -30åˆ†
â”œâ”€ é»„ç‰›åˆ·å•: æ°¸ä¹…å°ç¦
â””â”€ ä¿¡ç”¨æ¢å¤: æ¯æœˆ+5åˆ†ï¼ˆä¸Šé™ï¼‰
```

### 3. èµ„é‡‘å®‰å…¨ä¿éšœ

#### 3.1 å¤šé‡ç­¾åæœºåˆ¶

**èµ„é‡‘é‡Šæ”¾éœ€è¦å¤šæ–¹ç­¾å**ï¼š
```
æ­£å¸¸æµç¨‹ï¼ˆ2/3ç­¾åï¼‰:
ä¹°å®¶ç¡®è®¤ + æ™ºèƒ½åˆçº¦è‡ªåŠ¨ â†’ é‡Šæ”¾èµ„é‡‘

å¼‚å¸¸æµç¨‹ï¼ˆ3/3ç­¾åï¼‰:
ä¹°å®¶ç”³è¯‰ + å¹³å°ä»²è£ + æ™ºèƒ½åˆçº¦æ‰§è¡Œ â†’ é€€æ¬¾/é‡Šæ”¾

ç´§æ€¥æƒ…å†µï¼ˆå¹³å°ç‰¹æƒï¼‰:
ç³»ç»Ÿæ£€æµ‹åˆ°é‡å¤§é£é™© â†’ å¹³å°å¯æš‚åœèµ„é‡‘æµåŠ¨ â†’ è°ƒæŸ¥åå¤„ç†
```

**æ™ºèƒ½åˆçº¦å¤šç­¾å®ç°**ï¼š
```solidity
// å¤šç­¾é’±åŒ…åˆçº¦
contract MultiSigEscrow {
    address public platform;
    address public buyer;
    address public seller;
    
    mapping(uint256 => mapping(address => bool)) public signatures;
    
    function releasePayment(uint256 tokenId, address[] memory signers) public {
        require(signers.length >= 2, "Need at least 2 signatures");
        
        // éªŒè¯ç­¾å
        for (uint i = 0; i < signers.length; i++) {
            require(
                signatures[tokenId][signers[i]], 
                "Invalid signature"
            );
        }
        
        // é‡Šæ”¾èµ„é‡‘
        _releaseFunds(tokenId);
    }
    
    // å¹³å°ç´§æ€¥æš‚åœ
    function emergencyPause(uint256 tokenId) public onlyPlatform {
        escrows[tokenId].status = EscrowStatus.Paused;
        emit EmergencyPaused(tokenId);
    }
}
```

#### 3.2 ä¿è¯é‡‘åˆ¶åº¦

**æœå›­ä¿è¯é‡‘**ï¼š
```
ä¿è¯é‡‘è§„åˆ™:
â”œâ”€ æ–°å…¥é©»æœå›­: 10,000å…ƒä¿è¯é‡‘
â”œâ”€ ä¼˜è´¨æœå›­ï¼ˆä¿¡ç”¨ > 90åˆ†ï¼‰: 5,000å…ƒ
â”œâ”€ é¡¶çº§æœå›­ï¼ˆä¿¡ç”¨ > 95åˆ†ï¼‰: å…ä¿è¯é‡‘

ä¿è¯é‡‘ç”¨é€”:
â”œâ”€ èµ”ä»˜ä¹°å®¶æŸå¤±
â”œâ”€ è¿çº¦é‡‘æ‰£é™¤
â”œâ”€ å¹³å°å¤„ç½š
â””â”€ æ­£å¸¸ç»è¥ä¸ä½¿ç”¨

ä¿è¯é‡‘é‡Šæ”¾:
â”œâ”€ ç”³è¯·é€€å‡ºå¹³å°
â”œâ”€ æ‰€æœ‰è®¢å•å®Œç»“
â”œâ”€ æ— æœªè§£å†³çº çº·
â””â”€ 30å¤©åé‡Šæ”¾
```

#### 3.3 ä¿é™©æœºåˆ¶

**äº¤æ˜“ä¿é™©**ï¼š
```
å¹³å°æä¾›å…è´¹ä¿é™©:
â”œâ”€ è´¨é‡ä¿é™©: åæœåŒ…èµ”
â”œâ”€ è¿è¾“ä¿é™©: ä¸¢ä»¶å…¨èµ”
â”œâ”€ å»¶è¯¯ä¿é™©: è¶…æ—¶è¡¥å¿
â””â”€ ä¿¡ç”¨ä¿é™©: å–å®¶è·‘è·¯å¹³å°å…ˆèµ”

ä¿é™©ç†èµ”:
â”œâ”€ è‡ªåŠ¨åˆ¤å®š: ç®€å•æƒ…å†µè‡ªåŠ¨èµ”ä»˜
â”œâ”€ å¿«é€Ÿç†èµ”: 48å°æ—¶å†…åˆ°è´¦
â”œâ”€ å…ˆè¡Œèµ”ä»˜: å¹³å°å«ä»˜åå‘æœå›­è¿½å¿
â””â”€ é¢åº¦ä¸Šé™: å•ç¬”æœ€é«˜2000å…ƒ
```

---

## èµ„é‡‘ç®¡ç†

### 1. èµ„é‡‘æµè½¬å›¾

```
ä¹°å®¶æ”¯ä»˜ Â¥298
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ™ºèƒ½åˆçº¦æ‰˜ç®¡æ±    â”‚ â† å…¨é¢é”å®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
  èµ„é‡‘åˆ†é…ï¼ˆæ”¯ä»˜æ—¶ï¼‰
      â†“
â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â”‚         â”‚         â”‚         â”‚
å¹³å°æœåŠ¡è´¹   ç‰©æµè´¹    é¦–æ¬¾      å°¾æ¬¾
Â¥14.90     Â¥29.80   Â¥89.40   Â¥164.90
(5%)       (10%)    (30%)    (55%)
â”‚           â”‚         â”‚         â”‚
ç«‹å³æ‰£é™¤    å‘è´§é‡Šæ”¾  å‘è´§é‡Šæ”¾   æ”¶è´§é‡Šæ”¾
â”‚           â”‚         â”‚         â”‚
â†“           â†“         â†“         â†“
å¹³å°è´¦æˆ·   ç‰©æµå…¬å¸   æœå›­è´¦æˆ·  æœå›­è´¦æˆ·
```

### 2. æç°æœºåˆ¶

**æœå›­æç°**ï¼š
```
æç°æ¡ä»¶:
â”œâ”€ å·²ç¡®è®¤æ”¶è´§çš„è®¢å•
â”œâ”€ èµ„é‡‘å·²é‡Šæ”¾
â”œâ”€ æ— äº‰è®®çº çº·
â””â”€ å®Œæˆå®åè®¤è¯

æç°å‘¨æœŸ:
â”œâ”€ T+0: å®æ—¶åˆ°è´¦ï¼ˆæ”¶è´¹0.6%ï¼‰
â”œâ”€ T+1: æ¬¡æ—¥åˆ°è´¦ï¼ˆå…è´¹ï¼‰
â””â”€ æ¯å‘¨ä¸‰: æ‰¹é‡ç»“ç®—ï¼ˆå…è´¹ï¼‰

æç°é™åˆ¶:
â”œâ”€ å•æ—¥æœ€é«˜: 50,000å…ƒ
â”œâ”€ å•æœˆæœ€é«˜: 500,000å…ƒ
â””â”€ è¶…é¢æç°éœ€é¢å¤–å®¡æ ¸

æç°è®°å½•:
æ‰€æœ‰æç°è®°å½•æ°¸ä¹…ä¿å­˜ï¼Œå¯è¿½æº¯
```

### 3. é€€æ¬¾å¤„ç†

**é€€æ¬¾æµç¨‹**ï¼š
```
å…¨é¢é€€æ¬¾:
æ™ºèƒ½åˆçº¦ â†’ æ‰£é™¤å·²é‡Šæ”¾éƒ¨åˆ† â†’ é€€å›ä¹°å®¶

éƒ¨åˆ†é€€æ¬¾:
æ™ºèƒ½åˆçº¦ â†’ è®¡ç®—é€€æ¬¾é‡‘é¢ â†’ ä»æ‰˜ç®¡ä¸­æ‰£é™¤ â†’ é€€å›ä¹°å®¶

é€€æ¬¾æ—¶æ•ˆ:
â”œâ”€ è‡ªåŠ¨é€€æ¬¾: å®æ—¶åˆ°è´¦
â”œâ”€ ä»²è£é€€æ¬¾: 1-3ä¸ªå·¥ä½œæ—¥
â””â”€ è·¨å¢ƒé€€æ¬¾: 3-7ä¸ªå·¥ä½œæ—¥
```

---

## æŠ€æœ¯å®ç°

### 1. æ™ºèƒ½åˆçº¦æ ¸å¿ƒä»£ç 

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@openzeppelin/contracts/token/ERC721/ERC721.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

contract LycheeNFTPresale is ERC721, Ownable, ReentrancyGuard {
    
    // æ‰˜ç®¡çŠ¶æ€æšä¸¾
    enum EscrowStatus {
        None,
        Locked,      // èµ„é‡‘é”å®š
        Shipped,     // å·²å‘è´§
        Completed,   // å·²å®Œæˆ
        Disputed,    // æœ‰äº‰è®®
        Refunded     // å·²é€€æ¬¾
    }
    
    // æ‰˜ç®¡ä¿¡æ¯ç»“æ„
    struct Escrow {
        address buyer;
        address seller;
        uint256 amount;
        EscrowStatus status;
        uint256 createdAt;
        uint256 shippedAt;
        uint256 deliveredAt;
        uint256 confirmedAt;
        uint256 deliveryDeadline;
    }
    
    // çŠ¶æ€å˜é‡
    address public platform;
    uint256 public presalePrice;
    uint256 public platformFeeRate = 5;  // 5%
    uint256 public logisticsFeeRate = 10; // 10%
    uint256 public initialPaymentRate = 30; // 30%
    uint256 public finalPaymentRate = 55; // 55%
    
    mapping(uint256 => Escrow) public escrows;
    mapping(uint256 => bool) public nftLocked;
    
    // äº‹ä»¶
    event NFTPurchased(uint256 indexed tokenId, address buyer, uint256 amount);
    event NFTShipped(uint256 indexed tokenId, string trackingNumber);
    event DeliveryConfirmed(uint256 indexed tokenId, address buyer, uint256 amount);
    event DisputeRaised(uint256 indexed tokenId, address buyer, string reason);
    event DisputeResolved(uint256 indexed tokenId, address winner, uint256 refundAmount);
    event FundsReleased(uint256 indexed tokenId, address recipient, uint256 amount);
    
    constructor(uint256 _presalePrice) ERC721("Lychee NFT", "LYCHEE") {
        platform = msg.sender;
        presalePrice = _presalePrice;
    }
    
    // è´­ä¹°NFT
    function purchaseNFT(uint256 tokenId) public payable nonReentrant {
        require(msg.value >= presalePrice, "Insufficient payment");
        require(_exists(tokenId), "Token does not exist");
        require(ownerOf(tokenId) != msg.sender, "Already owned");
        
        address seller = ownerOf(tokenId);
        
        // æ‰£é™¤å¹³å°æœåŠ¡è´¹
        uint256 platformFee = (msg.value * platformFeeRate) / 100;
        payable(platform).transfer(platformFee);
        
        // å‰©ä½™èµ„é‡‘é”å®šåœ¨åˆçº¦ä¸­
        uint256 escrowAmount = msg.value - platformFee;
        
        // è½¬ç§»NFTæ‰€æœ‰æƒ
        _transfer(seller, msg.sender, tokenId);
        nftLocked[tokenId] = true;
        
        // åˆ›å»ºæ‰˜ç®¡è®°å½•
        escrows[tokenId] = Escrow({
            buyer: msg.sender,
            seller: seller,
            amount: escrowAmount,
            status: EscrowStatus.Locked,
            createdAt: block.timestamp,
            shippedAt: 0,
            deliveredAt: 0,
            confirmedAt: 0,
            deliveryDeadline: block.timestamp + 90 days // 3ä¸ªæœˆäº¤ä»˜æœŸé™
        });
        
        emit NFTPurchased(tokenId, msg.sender, msg.value);
    }
    
    // ç¡®è®¤å‘è´§
    function confirmShipment(uint256 tokenId, string memory trackingNumber) public {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.seller == msg.sender, "Not seller");
        require(escrow.status == EscrowStatus.Locked, "Invalid status");
        require(block.timestamp <= escrow.deliveryDeadline, "Delivery deadline passed");
        
        // é‡Šæ”¾ç‰©æµè´¹ + é¦–æ¬¾
        uint256 logisticsFee = (escrow.amount * logisticsFeeRate) / 100;
        uint256 initialPayment = (escrow.amount * initialPaymentRate) / 100;
        uint256 totalRelease = logisticsFee + initialPayment;
        
        payable(escrow.seller).transfer(totalRelease);
        
        escrow.status = EscrowStatus.Shipped;
        escrow.shippedAt = block.timestamp;
        
        emit NFTShipped(tokenId, trackingNumber);
        emit FundsReleased(tokenId, escrow.seller, totalRelease);
    }
    
    // ç¡®è®¤æ”¶è´§
    function confirmDelivery(uint256 tokenId) public nonReentrant {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.buyer == msg.sender, "Not buyer");
        require(escrow.status == EscrowStatus.Shipped, "Not shipped");
        
        // é‡Šæ”¾å°¾æ¬¾
        uint256 finalPayment = (escrow.amount * finalPaymentRate) / 100;
        payable(escrow.seller).transfer(finalPayment);
        
        // è§£é”NFT
        nftLocked[tokenId] = false;
        
        escrow.status = EscrowStatus.Completed;
        escrow.confirmedAt = block.timestamp;
        
        emit DeliveryConfirmed(tokenId, msg.sender, finalPayment);
        emit FundsReleased(tokenId, escrow.seller, finalPayment);
    }
    
    // è‡ªåŠ¨ç¡®è®¤ï¼ˆ7å¤©åï¼‰
    function autoConfirmDelivery(uint256 tokenId) public {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.status == EscrowStatus.Shipped, "Not shipped");
        require(escrow.shippedAt > 0, "No delivery record");
        require(block.timestamp >= escrow.shippedAt + 7 days, "Too early");
        
        // æ‰§è¡Œç¡®è®¤é€»è¾‘
        uint256 finalPayment = (escrow.amount * finalPaymentRate) / 100;
        payable(escrow.seller).transfer(finalPayment);
        
        nftLocked[tokenId] = false;
        escrow.status = EscrowStatus.Completed;
        escrow.confirmedAt = block.timestamp;
        
        emit DeliveryConfirmed(tokenId, escrow.buyer, finalPayment);
    }
    
    // å‘èµ·äº‰è®®
    function raiseDispute(uint256 tokenId, string memory reason) public {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.buyer == msg.sender, "Not buyer");
        require(
            escrow.status == EscrowStatus.Shipped || 
            escrow.status == EscrowStatus.Locked,
            "Invalid status"
        );
        
        escrow.status = EscrowStatus.Disputed;
        
        emit DisputeRaised(tokenId, msg.sender, reason);
    }
    
    // å¹³å°ä»²è£ï¼ˆåªæœ‰å¹³å°å¯è°ƒç”¨ï¼‰
    function resolveDispute(
        uint256 tokenId,
        bool buyerWins,
        uint256 refundRate
    ) public onlyOwner {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.status == EscrowStatus.Disputed, "Not in dispute");
        require(refundRate <= 100, "Invalid refund rate");
        
        uint256 remainingAmount = escrow.amount - 
            (escrow.amount * logisticsFeeRate / 100) -
            (escrow.amount * initialPaymentRate / 100);
        
        if (buyerWins) {
            // é€€æ¬¾ç»™ä¹°å®¶
            uint256 refundAmount = (remainingAmount * refundRate) / 100;
            uint256 sellerAmount = remainingAmount - refundAmount;
            
            if (refundAmount > 0) {
                payable(escrow.buyer).transfer(refundAmount);
            }
            if (sellerAmount > 0) {
                payable(escrow.seller).transfer(sellerAmount);
            }
            
            escrow.status = EscrowStatus.Refunded;
            emit DisputeResolved(tokenId, escrow.buyer, refundAmount);
        } else {
            // é‡Šæ”¾ç»™å–å®¶
            payable(escrow.seller).transfer(remainingAmount);
            escrow.status = EscrowStatus.Completed;
            emit DisputeResolved(tokenId, escrow.seller, 0);
        }
        
        nftLocked[tokenId] = false;
    }
    
    // è¶…æ—¶é€€æ¬¾ï¼ˆè¶…è¿‡äº¤ä»˜æœŸé™ï¼‰
    function refundDueToTimeout(uint256 tokenId) public {
        Escrow storage escrow = escrows[tokenId];
        require(escrow.status == EscrowStatus.Locked, "Invalid status");
        require(block.timestamp > escrow.deliveryDeadline, "Not timeout");
        
        // å…¨é¢é€€æ¬¾ç»™ä¹°å®¶
        payable(escrow.buyer).transfer(escrow.amount);
        
        escrow.status = EscrowStatus.Refunded;
        nftLocked[tokenId] = false;
        
        emit DisputeResolved(tokenId, escrow.buyer, escrow.amount);
    }
    
    // æŸ¥è¯¢æ‰˜ç®¡ä¿¡æ¯
    function getEscrowInfo(uint256 tokenId) public view returns (Escrow memory) {
        return escrows[tokenId];
    }
}
```

### 2. åç«¯APIè®¾è®¡

```typescript
// è®¢å•API
interface OrderAPI {
  // åˆ›å»ºè®¢å•
  POST /api/orders/create
  Body: {
    presale_id: string
    nft_token_id: string
    shipping_address: Address
    payment_method: string
  }
  
  // æ”¯ä»˜è®¢å•
  POST /api/orders/:orderId/pay
  Body: {
    payment_method: string
    payment_proof: string
  }
  
  // ç¡®è®¤å‘è´§
  POST /api/orders/:orderId/ship
  Body: {
    tracking_number: string
    logistics_company: string
    package_photos: string[]
  }
  
  // ç¡®è®¤æ”¶è´§
  POST /api/orders/:orderId/confirm
  Body: {
    rating: number
    comment: string
    photos: string[]
  }
  
  // å‘èµ·äº‰è®®
  POST /api/orders/:orderId/dispute
  Body: {
    reason: string
    evidence: string[]
    demand: string
  }
}

// æº¯æºAPI
interface TraceAPI {
  // ä¸Šä¼ æº¯æºæ•°æ®
  POST /api/trace/upload
  Body: {
    nft_token_id: string
    stage: string
    data: TraceData
    photos: string[]
  }
  
  // æŸ¥è¯¢æº¯æºè®°å½•
  GET /api/trace/:tokenId
  Response: TraceRecord[]
}

// ç›‘ç®¡API
interface AdminAPI {
  // å®¡æ ¸é¢„å”®æ´»åŠ¨
  POST /api/admin/presale/:presaleId/review
  Body: {
    approved: boolean
    reason: string
  }
  
  // ä»²è£äº‰è®®
  POST /api/admin/dispute/:disputeId/resolve
  Body: {
    decision: string
    refund_rate: number
    reason: string
  }
  
  // é£æ§é¢„è­¦
  GET /api/admin/risk/alerts
  Response: RiskAlert[]
}
```

### 3. æ•°æ®åº“è®¾è®¡

**æ ¸å¿ƒè¡¨ç»“æ„**ï¼š
```sql
-- è®¢å•è¡¨
CREATE TABLE orders (
    order_id VARCHAR(50) PRIMARY KEY,
    buyer_id VARCHAR(50) NOT NULL,
    seller_id VARCHAR(50) NOT NULL,
    nft_token_id VARCHAR(50) NOT NULL,
    presale_id VARCHAR(50) NOT NULL,
    
    -- é‡‘é¢ä¿¡æ¯
    total_amount DECIMAL(10, 2) NOT NULL,
    platform_fee DECIMAL(10, 2) NOT NULL,
    logistics_fee DECIMAL(10, 2) NOT NULL,
    initial_payment DECIMAL(10, 2) NOT NULL,
    final_payment DECIMAL(10, 2) NOT NULL,
    
    -- çŠ¶æ€ä¿¡æ¯
    status VARCHAR(20) NOT NULL,
    payment_status VARCHAR(20) NOT NULL,
    shipment_status VARCHAR(20) NOT NULL,
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    paid_at TIMESTAMP,
    shipped_at TIMESTAMP,
    delivered_at TIMESTAMP,
    confirmed_at TIMESTAMP,
    
    -- åŒºå—é“¾ä¿¡æ¯
    blockchain_tx_hash VARCHAR(66),
    escrow_address VARCHAR(42),
    
    INDEX idx_buyer (buyer_id),
    INDEX idx_seller (seller_id),
    INDEX idx_status (status),
    INDEX idx_created_at (created_at)
);

-- äº‰è®®è¡¨
CREATE TABLE disputes (
    dispute_id VARCHAR(50) PRIMARY KEY,
    order_id VARCHAR(50) NOT NULL,
    complainant_id VARCHAR(50) NOT NULL,
    respondent_id VARCHAR(50) NOT NULL,
    
    -- äº‰è®®å†…å®¹
    type VARCHAR(50) NOT NULL,
    reason TEXT NOT NULL,
    evidence JSONB,
    demand VARCHAR(200),
    
    -- å“åº”å†…å®¹
    response TEXT,
    response_evidence JSONB,
    
    -- ä»²è£ç»“æœ
    arbitrator_id VARCHAR(50),
    decision VARCHAR(50),
    refund_amount DECIMAL(10, 2),
    reason_text TEXT,
    
    -- çŠ¶æ€
    status VARCHAR(20) NOT NULL,
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    responded_at TIMESTAMP,
    resolved_at TIMESTAMP,
    
    FOREIGN KEY (order_id) REFERENCES orders(order_id),
    INDEX idx_order (order_id),
    INDEX idx_status (status)
);

-- æº¯æºè®°å½•è¡¨
CREATE TABLE trace_records (
    trace_id VARCHAR(50) PRIMARY KEY,
    nft_token_id VARCHAR(50) NOT NULL,
    presale_id VARCHAR(50) NOT NULL,
    
    -- æº¯æºæ•°æ®
    stage VARCHAR(50) NOT NULL,
    data JSONB NOT NULL,
    photos TEXT[],
    blockchain_hash VARCHAR(66),
    
    -- å®¡æ ¸ä¿¡æ¯
    verified BOOLEAN DEFAULT FALSE,
    verifier_id VARCHAR(50),
    verified_at TIMESTAMP,
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_nft (nft_token_id),
    INDEX idx_stage (stage),
    INDEX idx_created_at (created_at)
);
```

---

## æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

1. **ä¹°å®¶ä¿éšœ**
   - âœ… èµ„é‡‘æ‰˜ç®¡ï¼Œè´§åˆ°ä»˜æ¬¾
   - âœ… è´¨é‡é—®é¢˜å¯ç”³è¯‰é€€æ¬¾
   - âœ… å¹³å°æ‹…ä¿ï¼Œæ— å¿§è´­ç‰©

2. **å–å®¶ä¿éšœ**
   - âœ… åˆ†æ®µæ”¶æ¬¾ï¼Œç°é‡‘æµå¥½
   - âœ… å¹³å°æµé‡ï¼Œé”€å”®æ— å¿§
   - âœ… ä¿¡ç”¨ä½“ç³»ï¼Œä¼˜è´¨æº¢ä»·

3. **å¹³å°ä»·å€¼**
   - âœ… å»ºç«‹ä¿¡ä»»ï¼Œæ’®åˆäº¤æ˜“
   - âœ… æœåŠ¡è´¹æ”¶å…¥ç¨³å®š
   - âœ… æ•°æ®èµ„äº§ç§¯ç´¯

### ä¸ç¾å›¢æ¶ˆè´¹åˆ¸çš„ç›¸ä¼¼æ€§

| ç»´åº¦ | ç¾å›¢æ¶ˆè´¹åˆ¸ | è”æNFT |
|------|-----------|---------|
| **æ”¯ä»˜** | å…ˆä»˜æ¬¾åˆ°å¹³å° | å…ˆä»˜æ¬¾åˆ°åˆçº¦ |
| **æ¶ˆè´¹** | åˆ°åº—æ ¸é”€ | ç¡®è®¤æ”¶è´§ |
| **ç»“ç®—** | æ ¸é”€åT+1ç»™å•†å®¶ | ç¡®è®¤åé‡Šæ”¾ç»™æœå›­ |
| **ä¿éšœ** | æœªæ¶ˆè´¹å¯é€€æ¬¾ | æœªæ”¶è´§å¯é€€æ¬¾ |
| **ç›‘ç®¡** | å¹³å°æ‹…ä¿ | å¹³å°+åˆçº¦åŒé‡æ‹…ä¿ |

### åˆ›æ–°ç‚¹

1. **åŒºå—é“¾æ‰˜ç®¡** - æ¯”ä¸­å¿ƒåŒ–å¹³å°æ›´é€æ˜å¯ä¿¡
2. **NFTæƒç›Š** - æ•°å­—èµ„äº§å¯è½¬è®©ã€å¯å¢å€¼
3. **å…¨ç¨‹æº¯æº** - ä»ç§æ¤åˆ°é¤æ¡Œå…¨è®°å½•
4. **æ™ºèƒ½åˆçº¦** - è‡ªåŠ¨æ‰§è¡Œï¼Œå‡å°‘äººå·¥ä»‹å…¥
5. **ä¿¡ç”¨ä½“ç³»** - é“¾ä¸Šè®°å½•ï¼Œæ°¸ä¹…è¿½æº¯

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-05  
**ä½œè€…**: Lychee NFT Platform Team  
**å‚è€ƒ**: ç¾å›¢æ¶ˆè´¹åˆ¸ã€æ”¯ä»˜å®æ‹…ä¿äº¤æ˜“ã€æ·˜å®äº¤æ˜“æµç¨‹
